
# 手动生成

Wails CLI 为该项目做了大量重提，但有时最好手动构建您的项目。 本文件将讨论国家带头行动的不同运作以及如何以不同方式实现这一目标。

## 构建进程

当 `wails build` 或 `wils dev` 被使用时，Wails CLI 执行一个共同的构建过程：

    - 安装前端依赖关系
    - 构建前端项目
    - 生成构建素材
    - 编译应用程序
    - [optional] 压缩应用程序

### 安装前端依赖关系

#### CLI 步骤

- 如果给出了 `-s` 标志，这个步骤被跳过
- 检查 `wails.json` 来查看是否在密钥 `frontend中存在安装命令：安装`
- 如果没有，它跳过这个步骤
- 如果有，请检查前端目录中是否存在 `package.json` 如果不存在，它会跳过这个步骤
- 从 `package.json` 文件内容生成一个 MD5 和
- 它检查 `package.json是否存在。 d5` 如果存在， 将会比较它的内容(MD5 sum) 与生成的内容以查看内容是否已经改变。 如果他们是相同的，这个步骤将会跳过
- 如果 `package.json.md5` 不存在，它将使用生成的 MD5 和
- 如果现在需要构建，或者 `node_modules` 不存在。 或给出 `-f` 标志。安装命令是 在前端目录执行

#### 手动步骤

这个步骤可以从命令行或脚本安装 `npm`。

### 构建前端项目

#### Wails CLI

- 如果给出了 `-s` 标志，这个步骤被跳过
- 检查 `wails.json` 来查看是否在密钥 `frontend中存在构建命令：build`
- 如果没有，它跳过这个步骤
- 如果有，它将在前端目录执行

#### 手动步骤

这个步骤可以从命令行或脚本完成。 `npm 运行版本` 或任何前端构建脚本。

### 生成资产

#### Wails CLI

- 如果设置了 `-nopackage` 标志，此阶段将跳过
- 如果 `build/appicon.png` 文件不存在，默认创建一个
- 关于Windows，查看 [Windows 捆绑](#windows)
- 如果 `build/windows/icon.ico` 不存在，它将从 `build/appicon.png` 图像创建它。

##### 窗口

- 如果 `build/windows/icon.ico` 不存在，它将从 `build/appicon 创建它。 ng` 使用的图标大小为256、128、64、48、32和16。 这是使用 [winicon](https://github.com/leaanthony/winicon) 来完成的。
- 如果 `build/windows/<projectname>.manic` 文件不存在，它会从默认版本创建它。
- 编译应用程序作为生产版本 (上文)
- 使用 [赢家](https://github.com/tc-hib/winres) 将图标捆绑在一起并将其展示到 `.syso` 文件准备好链接中。

#### 手动步骤

- 使用 [winicon](https://github.com/leaanthony/winicon) CLI 工具 (或任何其他工具) 创建 `icon.ico`
- 为您的应用程序创建/更新一个 `.manic` 文件
- 使用 [赢家 CLI](https://github.com/tc-hib/go-winres) 生成一个 `.syso` 文件。

### 编译应用程序

#### Wails CLI

- 如果提供 `-clean` 标志， `构建` 目录被删除并重新创建
- 对于 `wails dev`, 使用了以下默认的去标志： `-tags dev -gcflags "all=-N -l"`
- 对于 `wails build`, 使用了以下默认的去标志: `-tags desktop,production -ldflags "-w -s"`
  - 在 Windows 上， `-ldflags "-w -h -H windowsgui"`
- 通过 `传递到 CLI 的额外标签` 被添加到默认值
- 使用 `-ldflags` 传递给CLI 的额外ldflags 将被添加到默认值
- `-o` 标志已通过
- 由 `指定的 Go 编译器` 指定的编译器将用于编译

#### 手动步骤

- 对于dev 构建，最小命令将是： `去构建-tags dev -gcflags "all=-N -l"`
- 对于生产构建，最低命令将是： `去构建-tags desktop,production -ldflags "-w -s -H windowsgui"`
- 请确保您在相同的目录中编译 `.syso` 文件

### 压缩应用程序

#### Wails CLI

- 如果给出 `-upx` 标志， `upx` 程序将运行以压缩应用程序的默认设置
- 如果 `-upxflags` 也被通过，这些标志被使用而不是默认的标志

#### 手动步骤

- 手动运行 `up [flags]` 来压缩应用程序。
