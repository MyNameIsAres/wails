# 动态资源

如果您想要动态地加载或生成您的前端资产，您可以使用 [资产处理程序](../reference/options#assetshandler) 选项实现这一点。 The AssetsHandler is a generic `http.Handler` which will be called for any non GET request on the assets server and for GET requests which can not be served from the bundled assets because the file is not found.

通过安装自定义AssetsHandler，您可以使用自定义asset服务器为自己的资产服务。

## 示例

在我们的示例项目中，我们将创建一个简单的资产处理程序，从磁盘上加载文件：

```go title=main.go {16-35,49}
package main

import (
    "embed"
    "fmt"
    "github.com/wailsapp/wails/v2"
    "github.com/wailsapp/wails/v2/pkg/options"
    "net/http"
    "os"
    "strings"
)

//go:embed frontend/dist
var assets embed.FS

type FileLoader struct {
    http.Handler
}

func NewFileLoader() *FileLoader {
    return &FileLoader{}
}

func (h *FileLoader) ServeHTTP(res http.ResponseWriter, req *http.Request) {
    var err error
    requestedFilename := strings.TrimPrefix(req.URL.Path, "/")
    println("Requesting file:", requestedFilename)
    fileData, err := os.ReadFile(requestedFilename)
    if err != nil {
        res.WriteHeader(http.StatusBadRequest)
        res.Write([]byte(fmt.Sprintf("Could not load file %s", requestedFilename)))
    }

    res.Write(fileData)
}

func main() {
    // Create an instance of the app structure
    app := NewApp()

    // Create application with options
    err := wails.Run(&options.App{
        Title:            "helloworld",
        Width:            1024,
        Height:           768,
        Assets:           assets,
        BackgroundColour: &options.RGBA{R: 27, G: 38, B: 54, A: 1},
        OnStartup:        app.startup,
        AssetsHandler:    NewFileLoader(),
        Bind: []interface{}{
            app,
        },
    })

    if err != nil {
        println("Error:", err)
    }
}
```

当我们使用 `wails dev`以开发模式运行应用程序时，我们将看到以下输出：

```
DEB | [ExternalAssetHandler] 加载 'http://localhost:3001/favicon.ico'
DEB | [ExternalAssetHandler] 加载 'http://localhost:3001/favicon.ico' 失败，使用 AssetHandler
请求文件：favicon.ico
```
As you can see, the assets handler is called when the default assets server is unable to serve the `favicon.ico` file.

如果您右键单击主应用程序并选择“检查”来提取devtools 您可以通过在控制台中输入以下内容来测试 此功能：

```
let response = 等待获取('不存在.txt');
```
这将在开发工具中产生一个错误。 我们可以看到错误是我们所期望的, 由 返回我们的自定义资产处理程序：

<p className="text--center">
    <img src="/img/assetshandler-does-not-exist.png"></img>
</p>

然而，如果我们要求 `go.mod`，我们将看到以下输出：

<p className="text--center">
    <img src="/img/assetshandler-go-mod.png"></img>
</p>

这种技术可以直接将图像加载到页面。 如果我们更新了默认的原版模板， 则替换了徽标图像：
```html
    <img id="logo" class="logo">
```
和：
```html
    <img src="build/appicon.png" style="width: 300px">
```
然后我们会看到以下几点：

<p className="text--center">
    <img src="/img/assetshandler-image.png" style={{"width": "75%"}}></img>
</p>

:::警告
以这种方式暴露您的文件系统是一种安全风险。 建议您正确管理文件系统访问
。
:::

